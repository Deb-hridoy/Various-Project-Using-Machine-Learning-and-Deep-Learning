# -*- coding: utf-8 -*-
"""Profit_Prediction_Regression_Project.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1OpYJTwH5VZbv3Pu-T1WQuBo7GsdUB9Ot
"""

import sklearn
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

"""## Import data"""

from google.colab import files
uploaded = files.upload()

df = pd.read_csv('online.csv')
df.head()

df.isnull().sum()

df.shape

"""## Separate X, y"""

x_data = df.drop(['Profit'], axis=1)
x_data.head()

y_data=df['Profit']
y_data.head()

"""## One hot encoding"""

city = pd.get_dummies(x_data, columns=['Area'], dtype=int)
city.head()

"""## Concatenation"""

x= x_data.drop('Area', axis=1)

x.head()

x_value= pd.concat([x, city], axis=1)

x_value

"""## Data Train_Test_Split"""

from sklearn.model_selection import train_test_split

x_train, x_test, y_train, y_test = train_test_split(x_value, y_data, test_size=0.25, random_state=42)

x_train.shape, x_test.shape, y_train.shape, y_test.shape

"""## Training and Testing"""

from sklearn.linear_model import LinearRegression

model_0 = LinearRegression()

model_0.fit(x_train, y_train)

prediction = model_0.predict(x_test)

pred = pd.DataFrame(prediction, columns=['Prediction'])
pred.head()

"""## Performance"""

from sklearn.metrics import r2_score

model_0_score = r2_score(y_test, prediction)

print(f"Performance of model: {model_0_score:.2f}")

model_0.score(x_test, y_test)

plt.scatter(y_test, prediction)
plt.show()